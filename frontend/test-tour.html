<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DriverJS Tour Test</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.3.6/dist/driver.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        .test-element {
            padding: 20px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .logo {
            background-color: #e3f2fd;
            border-color: #2196f3;
        }
        .navigation {
            background-color: #f3e5f5;
            border-color: #9c27b0;
        }
        .features {
            background-color: #e8f5e8;
            border-color: #4caf50;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .primary {
            background-color: #2196f3;
            color: white;
        }
        .secondary {
            background-color: #f44336;
            color: white;
        }
    </style>
</head>
<body>
    <h1>DriverJS Tour Test Page</h1>
    
    <div class="test-element logo" data-tour="logo">
        <h2>üè† Logo Section</h2>
        <p>This represents the main logo area of the Smart Agriculture System.</p>
    </div>
    
    <div class="test-element navigation" data-tour="navigation">
        <h2>üß≠ Navigation Menu</h2>
        <p>This represents the navigation menu with links to different sections.</p>
        <button>Crop Recommendation</button>
        <button>Marketplace</button>
        <button>Messages</button>
        <button>Profile</button>
    </div>
    
    <div class="test-element features" data-tour="features">
        <h2>‚ú® Key Features</h2>
        <p>This represents the features section showing platform capabilities.</p>
    </div>
    
    <div style="margin-top: 30px;">
        <button class="primary" onclick="startMainTour()">Start Main Tour</button>
        <button class="secondary" onclick="startFallbackTour()">Start Fallback Tour</button>
        <button onclick="resetTour()">Reset Tour State</button>
    </div>
    
    <div id="debug" style="margin-top: 20px; padding: 10px; background-color: #f0f0f0; border-radius: 4px;">
        <h3>Debug Info:</h3>
        <div id="debug-content"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/driver.js@1.3.6/dist/driver.js"></script>
    <script>
        let driverObj = null;
        
        // Tour steps configuration (same as in TourGuide.jsx)
        const tourSteps = [
            {
                element: '[data-tour="logo"]',
                popover: {
                    title: 'üè† Welcome to Smart Agriculture System',
                    description: 'This is your dashboard where you can access all the key features of our farming platform. Let\'s take a quick tour to help you get started!',
                    side: 'bottom',
                    align: 'center'
                }
            },
            {
                element: '[data-tour="navigation"]',
                popover: {
                    title: 'üß≠ Navigation Menu',
                    description: 'Use this navigation menu to access different sections of the platform. You can browse the market, get crop recommendations, and more.',
                    side: 'bottom',
                    align: 'center'
                }
            },
            {
                element: '[data-tour="features"]',
                popover: {
                    title: '‚ú® Key Features',
                    description: 'Here you can see the main features of our platform including crop recommendations, market insights, and farming information.',
                    side: 'top',
                    align: 'center'
                }
            }
        ];
        
        // Fallback tour steps
        const fallbackTourSteps = [
            {
                element: 'body',
                popover: {
                    title: 'üè† Welcome to Smart Agriculture System',
                    description: 'This is a test tour to verify Driver.js is working. The tour system is functioning correctly!',
                    side: 'bottom',
                    align: 'center'
                }
            }
        ];
        
        // Initialize driver.js
        function initDriver() {
            try {
                console.log('Initializing Driver.js...');
                driverObj = driver({
                    showProgress: true,
                    showButtons: ['next', 'previous', 'close'],
                    nextBtnText: 'Next ‚Üí',
                    prevBtnText: '‚Üê Previous',
                    doneBtnText: 'Finish Tour',
                    closeBtnText: 'Skip Tour',
                    progressText: 'Step {{current}} of {{total}}',
                    allowClose: true,
                    disableActiveInteraction: true,
                    onDestroyed: () => {
                        console.log('Tour destroyed');
                        updateDebug('Tour completed/destroyed');
                    },
                    onHighlighted: (element) => {
                        console.log('Element highlighted:', element);
                        updateDebug('Element highlighted: ' + element.tagName);
                    }
                });
                console.log('‚úÖ Driver.js initialized successfully');
                updateDebug('Driver.js initialized successfully');
            } catch (error) {
                console.error('‚ùå Failed to initialize Driver.js:', error);
                updateDebug('Failed to initialize Driver.js: ' + error.message);
            }
        }
        
        function startMainTour() {
            console.log('üöÄ Starting main tour...');
            updateDebug('Starting main tour...');
            
            if (!driverObj) {
                console.error('‚ùå Driver not initialized');
                updateDebug('Driver not initialized');
                return;
            }
            
            // Check if tour elements exist
            const logoElement = document.querySelector('[data-tour="logo"]');
            const navElement = document.querySelector('[data-tour="navigation"]');
            const featuresElement = document.querySelector('[data-tour="features"]');
            
            console.log('üîç Tour elements found:');
            console.log('- Logo:', logoElement);
            console.log('- Navigation:', navElement);
            console.log('- Features:', featuresElement);
            
            const stepsToUse = logoElement ? tourSteps : fallbackTourSteps;
            
            if (!logoElement) {
                console.warn('‚ö†Ô∏è Main tour elements not found, using fallback tour');
                updateDebug('Using fallback tour (elements not found)');
            } else {
                updateDebug('Using main tour (elements found)');
            }
            
            try {
                console.log('üìã Starting tour with steps:', stepsToUse);
                driverObj.drive(stepsToUse);
                console.log('‚úÖ Tour started successfully');
                updateDebug('Tour started successfully');
            } catch (error) {
                console.error('‚ùå Error starting tour:', error);
                updateDebug('Error starting tour: ' + error.message);
            }
        }
        
        function startFallbackTour() {
            console.log('üß™ Starting fallback tour...');
            updateDebug('Starting fallback tour...');
            
            if (!driverObj) {
                console.error('‚ùå Driver not initialized');
                updateDebug('Driver not initialized');
                return;
            }
            
            try {
                driverObj.drive(fallbackTourSteps);
                console.log('‚úÖ Fallback tour started successfully');
                updateDebug('Fallback tour started successfully');
            } catch (error) {
                console.error('‚ùå Error starting fallback tour:', error);
                updateDebug('Error starting fallback tour: ' + error.message);
            }
        }
        
        function resetTour() {
            if (driverObj) {
                driverObj.destroy();
            }
            updateDebug('Tour state reset');
        }
        
        function updateDebug(message) {
            const debugContent = document.getElementById('debug-content');
            const timestamp = new Date().toLocaleTimeString();
            debugContent.innerHTML += `<div>[${timestamp}] ${message}</div>`;
        }
        
        // Initialize when page loads
        window.addEventListener('load', () => {
            initDriver();
            updateDebug('Page loaded, Driver.js ready');
        });
    </script>
</body>
</html>
